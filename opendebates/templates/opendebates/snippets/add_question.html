{% if ALLOW_VOTING_AND_SUBMITTING_QUESTIONS %}
{% load i18n %}
{% load staticfiles %}
{% load cache %}

<div>
  <div id="sidebar_question_btn" {% if form.errors %}class="hidden"{% endif %}>
    <a href="{% url 'questions' %}" class="btn btn-block btn-primary active" type="button">
      {% blocktrans %}Submit an Issue{% endblocktrans %}
    </a>
  </div>
  <div id="add_question" class="{% if form.errors %} has-errors{% endif %}">
    <img src="{% static "images/add-question-header.png" %}" />
    <h2>{% blocktrans %}Submit an Issue{% endblocktrans %}</h2>

    <form action="{% url 'questions' %}" method="POST" class="form-inline">
      {% csrf_token %}
      {{ form.non_field_errors }}
      <fieldset>
        <!-- Text input-->
        <div class="control-group">
          <label class="control-label category" for="category">
            {% blocktrans %}Choose a Category{% endblocktrans %}
          </label>

          {% if form.errors.category %}
          {{ form.errors.category }}
          {% endif %}

          <div class="controls">
            <select name="category" class="selectpicker">
              <option>--</option>
              {% cache 331 add_question_iter_category category %}
                {% for iter_category in SUBMISSION_CATEGORIES %}
                <option {% if iter_category.id|slugify == form.data.category or iter_category.id == category.id %}selected{% endif %}
                        value="{{ iter_category.id }}">{{ iter_category.name }}</option>
                {% endfor %}
              {% endcache %}
            </select>
          </div>
        </div>

        <!-- Text input-->
        <div class="control-group">
          {% if form.errors.headline %}
          {{ form.errors.headline }}
          {% endif %}
          <div class="controls">
            <textarea id="headline" name="headline" type="text" class="input-large" maxlength="160"
                   placeholder="{% blocktrans %}Enter your issue here{% endblocktrans %}">{{ form.data.headline }}</textarea>
            <div class="text-limit-counter" data-total="160"><span class="count">160</span> / 160</div>
          </div>
        </div>

        <!-- Text input-->
        <div class="control-group">
          {% if form.errors.followup %}
          {{ form.errors.followup }}
          {% endif %}
          <div class="controls">
            <textarea id="followup" name="followup" type="text" rows="4" class="input-large" maxlength="2000"
                      placeholder="{% blocktrans %}Enter your supporting text here"{% endblocktrans %}>{{ form.data.followup }}</textarea>
            <div class="text-limit-counter" data-total="2000"><span class="count">2000</span> / 2000</div>
          </div>
        </div>

        <!-- Text input-->
        <div class="control-group">
          {% if form.errors.citation %}
          {{ form.errors.citation }}
          {% endif %}
          <div class="controls">
            <input id="citation" name="citation" type="text" class="input-large" value="{{ form.data.citation }}"
                   placeholder="{% blocktrans %}Optional: link to supporting material{% endblocktrans %}">
          </div>
        </div>

        <div class="control-group">
          {% if form.errors.happened %}
          {{ form.errors.happened }}
          {% endif %}
          <div class="controls">
            <input id="happened" name="happened" type="text" class="input-large mydatepicker" value="{{ form.data.happened }}"
                   placeholder="{% blocktrans %}Optional: when did it happen{% endblocktrans %}">
          </div>
        </div>

      <div class="control-group">
          {% if form.errors.is_positive %}
          {{ form.errors.is_positive }}
          {% endif %}
          <div class="controls">
            <input id="is_positive" name="is_positive" type="checkbox" class="input-large" value="1"
                   placeholder="{% blocktrans %}Was this positive or negative{% endblocktrans %}"
            {% if form.data.is_positive %}checked="checked"{% endif %}>
              <label for="is_positive">Was this positive?</label>
          </div>
        </div>

        <!-- Button -->
        <div class="control-group">
          <div class="controls controls-submit">
            <button
               id="submitquestionbutton"
               name="submitquestionbutton"
               class=" btn btn-primary submitquestionbutton"
               data-add-question-url="{% url 'questions' %}">
              {% blocktrans %}Add Your Issue{% endblocktrans %}</button>
          </div>
        </div>

      </fieldset>
    </form>
  </div>
</div>
{% endif %}
